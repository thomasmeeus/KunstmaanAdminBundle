parameters:
    kunstmaan_admin.menubuilder.class: Kunstmaan\AdminBundle\Helper\Menu\MenuBuilder

services:
    kunstmaan_admin.menubuilder:
        class: %kunstmaan_admin.menubuilder.class%
        arguments: ["@translator", "@request"]
        scope: request
        
    kunstmaan_admin.menu.adaptor.settings:
        class: Kunstmaan\AdminBundle\Helper\Menu\SettingsMenuAdaptor
        tags:
            -  { name: 'kunstmaan_admin.menu.adaptor' }
        
    kunstmaan_admin.menu.adaptor.modules:
        class: Kunstmaan\AdminBundle\Helper\Menu\ModulesMenuAdaptor
        tags:
            -  { name: 'kunstmaan_admin.menu.adaptor' }

    kunstmaan_admin.form.type.urlchooser:
        class: Kunstmaan\AdminBundle\Form\Type\URLChooserType
        tags:
            - { name: 'form.type', alias: 'urlchooser' }
            
    kunstmaan_admin.handler.log:
        class: Kunstmaan\AdminBundle\Helper\LogHandler
        arguments: ["@monolog.logger.doctrine", "@security.context", "@doctrine.orm.entity_manager"]
        tags:
            - { name: 'log_handler' }

    kunstmaan_admin.login.listener:
        class: Kunstmaan\AdminBundle\EventListener\LoginListener
        arguments: ["@security.context", "@doctrine.orm.entity_manager"]
        tags:
            - { name: 'kernel.event_listener', event: 'security.interactive_login' }
            
    kunstmaan_admin.logout.listener:
        class: Kunstmaan\AdminBundle\EventListener\LogoutListener
        arguments:  ["@security.context", "@doctrine.orm.entity_manager"]
        tags:
            - { name: 'monolog.logger', channel: 'security' }
            
    kunstmaan_admin.menu.twig.extension:
        class: Kunstmaan\AdminBundle\Twig\Extension\MenuTwigExtension
        arguments: ["@kunstmaan.admin.menubuilder"]
        tags:
            -  { name: 'twig.extension' }

    kunstmaan_admin.localeswitcher.twig.extension:
        class: Kunstmaan\AdminBundle\Twig\Extension\LocaleSwitcherTwigExtension
        tags:
            -  { name: 'twig.extension' }

    kunstmaan_admin.locale.twig.extension:
        class: Kunstmaan\AdminBundle\Twig\Extension\DateByLocaleExtension
        tags:
            - { name: 'twig.extension' }

    kunstmaan_admin.formtools.twig.extension:
        class: Kunstmaan\AdminBundle\Twig\Extension\FormToolsExtension
        tags:
            - { name: 'twig.extension' }
 
    kunstmaan_admin.permissions.twig.extension:
        class: Kunstmaan\AdminBundle\Twig\Extension\AdminPermissionsTwigExtension
        tags:
            -  { name: 'twig.extension' }

# This should no longer be necessary (only needed for Symfony 2.0)
#    security.acl.object_identity_retrieval_strategy:
#        class: Kunstmaan\AdminBundle\Helper\Security\Acl\Domain\ObjectIdentityRetrievalStrategy
#        arguments: ["@doctrine.orm.entity_manager"]

    kunstmaan_admin.acl.helper:
        class: Kunstmaan\AdminBundle\Helper\Security\Acl\AclHelper
        arguments: ["@doctrine.orm.entity_manager", "@security.context"]

    kunstmaan_admin.acl.native.helper:
        class: Kunstmaan\AdminBundle\Helper\Security\Acl\AclNativeHelper
        arguments: ["@doctrine.orm.entity_manager", "@security.context"]

    kunstmaan_admin.guest.security.authentication.listener:
        class: Kunstmaan\AdminBundle\Helper\Security\Http\Firewall\GuestUserListener
        arguments: ["@security.context", "user_provider", "provider_key"]
        tags:
            - { name: 'monolog.logger', channel: 'security' }
        
    kunstmaan_admin.guest.security.authentication.provider:
        class: Kunstmaan\AdminBundle\Helper\Security\Authentication\Provider\GuestUserProvider
        arguments: [""]

    kunstmaan_admin.permissionadmin:
        class: Kunstmaan\AdminBundle\Helper\Security\Acl\Permission\PermissionAdmin
        arguments: ["@doctrine.orm.entity_manager", "@security.context", "@security.acl.provider", "@security.acl.object_identity_retrieval_strategy", "@kernel"]
